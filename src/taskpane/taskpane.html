<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SpiraPlan Importer</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet"
        href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/9.6.1/css/fabric.min.css" />
    <!-- For more information on Office UI Fabric, visit https://developer.microsoft.com/fabric. -->
    <link rel="stylesheet"
        href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.2.0/css/fabric.components.min.css" />
    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
    <header class="header">
        <!--We don't have the image asset file as it stands now-->
        <img alt="Spira Logo" src="/assets/inf-icon-80.png" class="header-logo" />
        <h3 class="header-heading">SpiraPlan Importer<br></h3>
    </header>
    <!-- error pop-up -->
    <div id="pop-up" class="pop-up hidden">
        <button type="button" id="pop-up-close" class="close">&#xD7;</button>
        <p id="pop-up-text">pop!<br></p>
        <div id="progress-bar" class="hidden mb-md">
            <div id="progress-bar-progress"></div>
        </div>
        <button type="button" id="pop-up-ok" class="ok ms-Button l">Confirm</button>
    </div>
    <!--auth page-->
    <div id="panel-auth" class="panel">
        <p class="well">
            Learn how to use this app via the <a id="lnk-help-login" href="#">mini help</a>, or read our <a
                target="_blank"
                href="https://spiradoc.inflectra.com/Unit-Testing-Integration/Using-Test-Runner-For-Excel/">full
                documentation</a>.
        </p>
        <h3 class="mt-md mb-0" id="login-prompt">Connect to your Spira app</h3>
        <p id="login-err" class="error-message"></p>
        <ul class="form">
            <li class="form-pair">
                <label class="form-label ms-Label" for="input-url">
                    Spira URL:
                </label>
                <input class="form-input" id="input-url" name="URL" placeholder="https://<your-site-name>.com"
                    type="text" />
            </li>
            <li class="form-pair">
                <label class="form-label ms-Label" for="input-username">
                    User Name:
                </label>
                <input class="form-input" id="input-username" name="user-name" placeholder="User Name" type="text" />
            </li>
            <li class="form-pair">
                <label class="form-label ms-Label" for="input-password">
                    RSS Token:
                </label>
                <input class="form-input" id="input-password" name="password" placeholder="{Your-RSS-Token}"
                    type="password" />
            </li>
        </ul>

        <div class="mt-md" id="login-buttons">
            <button class="action ms-Button ms-Button--primary fade" id="btn-login"
                title="Login using details filled out above" type="button">
                Log In
            </button>
            <button class="ms-Button ms-Button--default fade" id="btn-help-login" title="View help screens"
                type="button">
                Help
            </button>
            <!--Remove this before deployment-->
            <button class="ms-Button ms-Button--default fade" id="dev-mode" title="View help screens" type="button">
                DevMode
            </button>
        </div>
        <p class="mt-md mb-0">
            <small>
                Don't use SpiraPlan? Get a demo, purchase or learn more about SpiraPlan <a target="_blank"
                    href="https://www.inflectra.com/Trial/SpiraPlan.aspx">here</a>.
            </small>
        </p>
    </div>

    <!--Main screen-->
    <div id="main-screen" class="hidden">

        <div id="app-body" class="ms-welcome__main" style="display: none;">
            <button type="button" id="test">test</button>
            <p style="left: 0; margin-left: 0">1. Select the product you wish to import to:</p>
            <select id="project-select" class="selectors"></select>
            <!--Turn this into radio buttons of some sort which fit the theming instead of dd-->
            <p id="artifact-select-text" class="mt-md hidden">2. Select the artifact type you want to import:</p>
            <div id="artifact-select" class="mt-0">
                <button type="button" class="action artifact-button fade hidden" id="select-requirements">
                    Requirements
                </button>
                <button type="button" class="action artifact-button fade hidden" id="select-test-cases">
                    Test Cases
                </button>
            </div>
            <p class="error-message hidden" id="styles-err"></p>
        </div>
        <!--These style-block elements are hugging the bottom of the page for some reason.
        It looks perfect after you confirm the styles (and they are valid) and the send to
        spira button appears, but before that it behaves oddly. Unsure how to fix.-->
        <div id="req-style-mappings" class="styles-block mt-md hidden">
            <p class="style-prompt">3. Select the styles to use for Requirements:</p>
            <label for="req-style-select1" class="style-labels">Indent Level 1:</label>
            <select title="req-style-select1" id="req-style-select1" class="style-selector mb-sm"></select>
            <label for="req-style-select2" class="style-labels">Indent Level 2:</label>
            <select title="req-style-select2" id="req-style-select2" class="style-selector mb-sm"></select>
            <label for="req-style-select3" class="style-labels">Indent Level 3:</label>
            <select title="req-style-select3" id="req-style-select3" class="style-selector mb-sm"></select>
            <label for="req-style-select4" class="style-labels">Indent Level 4:</label>
            <select title="req-style-select4" id="req-style-select4" class="style-selector mb-sm"></select>
            <label for="req-style-select5" class="style-labels">Indent Level 5:</label>
            <select title="req-style-select5" id="req-style-select5" class="style-selector mb-sm"></select>
            <div class="style-buttons mb-md">
                <button type="button" id="confirm-req-style-mappings"
                    class="action ms-Button ms-Button--primary style-button fade">
                    <span class="ms-Button-label">Validate Styles</span>
                </button>
            </div>
        </div>
        <div id="test-style-mappings" class="styles-block mt-md hidden">
            <p class="style-prompt">3. Select the styles to use for Test Cases:</p>
            <h4 style="margin-top: 1em; margin-bottom: 0;">Test Cases:</h4>
            <label for="test-style-select1" class="style-labels">Folder Name:</label>
            <select title="test-style-select1" id="test-style-select1" class="style-selector"></select>
            <label for="test-style-select2" class="style-labels">Test Name:</label>
            <select title="test-style-select2" id="test-style-select2" class="style-selector"></select>
            <h4 style="margin-top: 1em; margin-bottom: 0;">Test Steps:</h4>
            <div>
                <label for="header-check">Using header rows:</label><input type="checkbox" id="header-check"
                    title="header-check" />
                <span class="tooltip" tooltip="Check this box if you start each of your Test Step tables with a header row. 
                    The header row will be omitted when sending to Spira.">?</span>
            </div>
            <label for="test-style-select3" class="style-labels" style="margin-top: 0">Description:</label>
            <select title="test-style-select3" id="test-style-select3" class="style-selector"></select>
            <label for="test-style-select4" class="style-labels">Expected Result:</label>
            <select title="test-style-select4" id="test-style-select4" class="style-selector"></select>
            <label for="test-style-select5" class="style-labels">Sample Data:</label>
            <select title="test-style-select5" id="test-style-select5" class="style-selector"></select>

            <div class="style-buttons">
                <button type="button" id="confirm-test-style-mappings"
                    class="action ms-Button ms-Button--primary style-button fade">
                    <span class="ms-Button-label">Validate Styles</span>
                </button>
            </div>
        </div>
        <div id="send-to-spira" class="hidden">
            <p id="send-err" class="error-message"></p>
            <p>4. Check your selection, then send to spira:</p>
            <button class="action ms-Button ms-Button--primary fade" id="send-to-spira-button" title="Send-to-spira"
                type="button">
                Send to Spira
            </button>
        </div>
        <div id="bottom-buttons" class="mt-lg">
            <button type="button" id="log-out" class="action ms-Button ms-Button--default fade">
                <span class="ms-Button-label">Log-Out</span>
            </button>
            <button type="button" id="help" class="action ms-Button ms-Button--default fade">
                <span class="ms-Button-label">Help</span>
            </button>
        </div>
    </div>
    <!-- footer -->
    <footer class="footer">
        <a href="https://www.inflectra.com" target="_blank">
            <img alt="inflectra insignia" src="https://files.inflectra.com/google/sheets/by_inflectra.png"
                class="footer-logo">
        </a>
    </footer>
</body>

</html>